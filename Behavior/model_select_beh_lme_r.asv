%% optional Model Selection for Beh. Data
%This needs to be run after already running the LME_Modeling_r script
%So the table and such is still in the workspace
%ignore up to line 67, just notes/readability
%Last updated 5/13/21 Drew Schreiner
%% take full n6 model with all interactions
%remove variables one at a time and compare them to the full model
%Input to fitlme requires a character/string vector. Bad readability, so
%all this will go into one line for the FULL n6 model
%for readability, break up the model specifications by n-backs, ma, and
%general variables
%random effects
(1|mouse_indicator)+(1|day_indicator)
%general trend/control variables (cumulative reward, time in session, %over
%criteria
LP_Timestamps_All + criteria_percent_indicator
%n1 through n6 durations. Only go to n6 since we know past n6 there is not
%shuffle difference. Also include the duration moving average n-7 to n-60
moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All

%n1 variable main effects. HE, ipi, reward, upstate
HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All
%n1 dur interactions with n1 variables
n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All 
%n1 dur interactions with control variables
n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator + n_minus_one_Durations_All:total_reward_indicator_All

%n2 variable main effects. HE, ipi, reward, upstate
HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All
%n2 dur interactions with n2 variables
n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All 
%n2 dur interactions with control variables
n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator + n_minus_two_Durations_All:total_reward_indicator_All

%n3 variable main effects. HE, ipi, reward, upstate
HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All
%n3 dur interactions with n3 variables
n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All 
%n3 dur interactions with control variables
n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator + n_minus_three_Durations_All:total_reward_indicator_All

%n4 variable main effects. HE, ipi, reward, upstate
HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All
%n4 dur interactions with n4 variables
n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All 
%n4 dur interactions with control variables
n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator + n_minus_four_Durations_All:total_reward_indicator_All

%n5 variable main effects. HE, ipi, reward, upstate
HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All
%n5 dur interactions with n5 variables
n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All 
%n5 dur interactions with control variables
n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator + n_minus_five_Durations_All:total_reward_indicator_All

%n6 variable main effects. HE, ipi, reward, upstate
HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All
%n6 dur interactions with n6 variables
n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All 
%n6 dur interactions with control variables
n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator + n_minus_six_Durations_All:total_reward_indicator_All

%Moving Average
%Moving Avg. dur interactions with n1 variables
moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All 
%Moving Avg. dur interactions with control variables
moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator + moving_average_lp_length_n7andback_All:total_reward_indicator_All

%% Full model
%order is: LP_Durations_ALL ~  + Moving average n1 and trend interactions +n1 variables and interactions incl trends  + n2 variables and interactions incl trends +
% n3 variables and interactions incl trends + n4 variables and interactions incl trends + n5 variables and interactions incl trends+ n6 variables and interactions incl trends+ 
% Durations n1 through  n6 and mov avg + general trend main effects + random effects
model_spec_FULL_n6 = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +  LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6 = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6);
lme_FULL_n6_names = lme_FULL_n6.CoefficientNames';
lme_FULL_n6_coef = lme_FULL_n6.Coefficients.Estimate;
lme_FULL_n6_se = lme_FULL_n6.Coefficients.SE;
lme_FULL_n6_pval = lme_FULL_n6.Coefficients.pValue;
lme_FULL_n6_ftest = anova(lme_FULL_n6);
lme_FULL_n6_ftest_pval = lme_FULL_n6_ftest.pValue;
lme_FULL_n6_ftest_fstat = lme_FULL_n6_ftest.FStat

%create an array that is as long as the num of coef
%This will show you the change in BIC from ADDING this term (i.e., negative
%values = term doesnt improve, positive values = does improve)
BIC_for_variable_Array =  NaN(length(lme_FULL_n6.CoefficientNames),1);

%first we will remove individual n1 terms. If any of them fail to improve
%the model (via BIC reduction), we will (eventually) not only remove them
%from n1, but from all subsequent nbacks. Though for now, we will simply
%not test those individual terms at the further n-backs so that we can do
%everything in relation to this full model.
%% Testing Terms with BIC
%Test n-1dur:n-1He int
model_spec_FULL_n6_minus_n1he_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +   ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1he_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1he_int);
compare(lme_FULL_n6_minus_n1he_int,lme_FULL_n6)
BIC_for_variable_Array(47) = lme_FULL_n6_minus_n1he_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Keep n-1 dur:n-1 He int

%Test n-1He ME
model_spec_FULL_n6_minus_n1he_ME ='LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1he_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1he_ME);
compare(lme_FULL_n6_minus_n1he_ME,lme_FULL_n6)
BIC_for_variable_Array(15) = lme_FULL_n6_minus_n1he_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;

%Keepn-1 He ME

%Test n-1he: Mov. Avg. int
model_spec_FULL_n6_minus_n1he_MAint ='LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +     ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1he_MAint = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1he_MAint);
compare(lme_FULL_n6_minus_n1he_MAint,lme_FULL_n6)
BIC_for_variable_Array(73) = lme_FULL_n6_minus_n1he_MAint.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Keep n-1he: Mov. Avg. Int

%Test n-1dur:n-1 IPI int
model_spec_FULL_n6_minus_n1ipi_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +   n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1ipi_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1ipi_int);
compare(lme_FULL_n6_minus_n1ipi_int,lme_FULL_n6)
BIC_for_variable_Array(59) = lme_FULL_n6_minus_n1ipi_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Keep n-1 dur:n-1 IPI int

%Test n-1 IPI ME
model_spec_FULL_n6_minus_n1ipi_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All +  n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1ipi_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1ipi_ME);
compare(lme_FULL_n6_minus_n1ipi_ME,lme_FULL_n6)
BIC_for_variable_Array(22) = lme_FULL_n6_minus_n1ipi_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%IPI doesn't improve BIC, but keep ME since n1 int is sig

%Test n-1 IPI: Mov. Avg. int
model_spec_FULL_n6_minus_n1ipi_MAint = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +   moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1ipi_MAint = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1ipi_MAint);
compare(lme_FULL_n6_minus_n1ipi_MAint,lme_FULL_n6)
BIC_for_variable_Array(75) = lme_FULL_n6_minus_n1ipi_MAint.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
% n-1 IPI: Mov. Avg. Int doesnt improve BIC, but keep to compare to ipi:n1

%Test n-1dur:n-1 Rew int
model_spec_FULL_n6_minus_n1rew_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1rew_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1rew_int);
compare(lme_FULL_n6_minus_n1rew_int,lme_FULL_n6)
BIC_for_variable_Array(35) = lme_FULL_n6_minus_n1rew_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Remove n-1 dur:n-1 Rew int by BIC - however, null effect of reward is
%interesting, so keep in model

%Test n-1 Rew ME
model_spec_FULL_n6_minus_n1rew_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 +  up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1rew_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1rew_ME);
compare(lme_FULL_n6_minus_n1rew_ME,lme_FULL_n6)
BIC_for_variable_Array(2) = lme_FULL_n6_minus_n1rew_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%n-1 Reward ME doesnt improve BIC, but again, null is interesting

%Test n-1 Rew: Mov. Avg. int
model_spec_FULL_n6_minus_n1rew_MAint = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All +  moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1rew_MAint = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1rew_MAint);
compare(lme_FULL_n6_minus_n1rew_MAint,lme_FULL_n6)
BIC_for_variable_Array(71) = lme_FULL_n6_minus_n1rew_MAint.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
% n-1 Rew: Mov. Avg. Int doesnt improve BIC, but null interesting

%Test n-1dur:n-1 State int (cumsum up state indicator var)
model_spec_FULL_n6_minus_n1state_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All +   HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1state_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1state_int);
compare(lme_FULL_n6_minus_n1state_int,lme_FULL_n6)
BIC_for_variable_Array(65) = lme_FULL_n6_minus_n1state_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Remove n-1 dur:n-1 State int 

%Test n-1 State ME
model_spec_FULL_n6_minus_n1state_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All +  n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1state_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1state_ME);
compare(lme_FULL_n6_minus_n1state_ME,lme_FULL_n6)
BIC_for_variable_Array(28) = lme_FULL_n6_minus_n1state_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Remove n-1 State ME

%Test n-1 State: Mov. Avg. int
model_spec_FULL_n6_minus_n1state_MAint = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1state_MAint = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1state_MAint);
compare(lme_FULL_n6_minus_n1state_MAint,lme_FULL_n6)
BIC_for_variable_Array(76) = lme_FULL_n6_minus_n1state_MAint.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove n-1 State: Mov. Avg. Int
%State main effect and interactions all worse by BIC, remove term from
%model

%Test n-1dur:Timestamps int
model_spec_FULL_n6_minus_ts_n1int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  +  n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_ts_n1int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_ts_n1int);
compare(lme_FULL_n6_minus_ts_n1int,lme_FULL_n6)
BIC_for_variable_Array(53) = lme_FULL_n6_minus_ts_n1int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Keep n-1 dur:n-1 Timestamps int

%Test n-1 Timestamps ME
model_spec_FULL_n6_minus_ts_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +    criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_ts_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_ts_ME);
compare(lme_FULL_n6_minus_ts_ME,lme_FULL_n6)
BIC_for_variable_Array(21) = lme_FULL_n6_minus_ts_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Timestamps ME does not improve model, but keep due to interaction with n1

%Test TimeStamps: Mov. Avg. int
model_spec_FULL_n6_minus_ts_MAint = 'LP_Durations_All ~  moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_ts_MAint = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_ts_MAint);
compare(lme_FULL_n6_minus_ts_MAint,lme_FULL_n6)
BIC_for_variable_Array(74) = lme_FULL_n6_minus_ts_MAint.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
% Timestamps: Mov. Avg. Int does not improve model, but keep due to int
% with n1

%Test n-1dur:Criteria% int
model_spec_FULL_n6_minus_criteria_n1int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All +     n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_criteria_n1int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_criteria_n1int);
compare(lme_FULL_n6_minus_criteria_n1int,lme_FULL_n6)
BIC_for_variable_Array(41) = lme_FULL_n6_minus_criteria_n1int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Keep n-1 dur:n-1 Criteria% int

%Test n-1 Criteria% ME
model_spec_FULL_n6_minus_criteria_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All +  (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_criteria_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_criteria_ME);
compare(lme_FULL_n6_minus_criteria_ME,lme_FULL_n6)
BIC_for_variable_Array(14) = lme_FULL_n6_minus_criteria_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Keepn-1 Criteria% ME

%Test Criteria%: Mov. Avg. int
model_spec_FULL_n6_minus_criteria_MAint = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All +    moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_criteria_MAint = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_criteria_MAint);
compare(lme_FULL_n6_minus_criteria_MAint,lme_FULL_n6)
BIC_for_variable_Array(72) = lme_FULL_n6_minus_criteria_MAint.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%Keep Criteria%: Mov. Avg. Int

%now lets do each duration and the mov avg. main effects. N3 ends up not
%improving model, however this may be due to all the interaction terms
%which we will remove. Keep for now and test in the reduced model.
%moving average
model_spec_FULL_n6_minus_MA = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All +  n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_MA = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_MA);
compare(lme_FULL_n6_minus_MA,lme_FULL_n6)
BIC_for_variable_Array(34) = lme_FULL_n6_minus_MA.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;

%n1
model_spec_FULL_n6_minus_n1 = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All +  n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n1 = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n1);
compare(lme_FULL_n6_minus_n1,lme_FULL_n6)
BIC_for_variable_Array(8) = lme_FULL_n6_minus_n1.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;

%n2
model_spec_FULL_n6_minus_n2 = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All +  n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2 = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2);
compare(lme_FULL_n6_minus_n2,lme_FULL_n6)
BIC_for_variable_Array(9) = lme_FULL_n6_minus_n2.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;

%n3
model_spec_FULL_n6_minus_n3 = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All +  n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n3 = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n3);
compare(lme_FULL_n6_minus_n3,lme_FULL_n6)
BIC_for_variable_Array(10) = lme_FULL_n6_minus_n3.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;

%n4
model_spec_FULL_n6_minus_n4 = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All +  n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n4 = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n4);
compare(lme_FULL_n6_minus_n4,lme_FULL_n6)
BIC_for_variable_Array(11) = lme_FULL_n6_minus_n4.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;

%n5
model_spec_FULL_n6_minus_n5 = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All +  n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n5 = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n5);
compare(lme_FULL_n6_minus_n5,lme_FULL_n6)
BIC_for_variable_Array(12) = lme_FULL_n6_minus_n5.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;

%n6
model_spec_FULL_n6_minus_n6 = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All +    LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n6 = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n6);
compare(lme_FULL_n6_minus_n6,lme_FULL_n6)
BIC_for_variable_Array(13) = lme_FULL_n6_minus_n6.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;

%n2 interactions
%we need to test n2 HE ME and int, n2:total reward, n2:criteria%, ipi2 ME,
%rewn2 ME, ts:n2
%n2 he int
model_spec_FULL_n6_minus_n2he_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +     ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2he_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2he_int);
compare(lme_FULL_n6_minus_n2he_int,lme_FULL_n6)
BIC_for_variable_Array(48) = lme_FULL_n6_minus_n2he_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove n2 he:int

model_spec_FULL_n6_minus_n2he_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All +  ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2he_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2he_ME);
compare(lme_FULL_n6_minus_n2he_ME,lme_FULL_n6)
BIC_for_variable_Array(16) = lme_FULL_n6_minus_n2he_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove n - 2 he ME 

%rewn-2 ME 
model_spec_FULL_n6_minus_n2rew_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 +  up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2rew_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2rew_ME);
compare(lme_FULL_n6_minus_n2rew_ME,lme_FULL_n6)
BIC_for_variable_Array(3) = lme_FULL_n6_minus_n2rew_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove rewn-2 ME

%ipi2 ME 
model_spec_FULL_n6_minus_n2ipi_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All +  n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2ipi_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2ipi_ME);
compare(lme_FULL_n6_minus_n2ipi_ME,lme_FULL_n6)
BIC_for_variable_Array(23) = lme_FULL_n6_minus_n2ipi_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove n2 ipi ME by BIC - however ipi2:n2 improves model so keep the main
%effect in

%ipi2:n2 int 
model_spec_FULL_n6_minus_n2ipi_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +   n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2ipi_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2ipi_int);
compare(lme_FULL_n6_minus_n2ipi_int,lme_FULL_n6)
BIC_for_variable_Array(60) = lme_FULL_n6_minus_n2ipi_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%keep ipi2:n2 int

%criteria%: n -2
model_spec_FULL_n6_minus_n2crit_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2crit_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2crit_int);
compare(lme_FULL_n6_minus_n2crit_int,lme_FULL_n6)
BIC_for_variable_Array(42) = lme_FULL_n6_minus_n2crit_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%n-2:criteria% remove

%TS: n -2
model_spec_FULL_n6_minus_n2ts_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All +  n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2ts_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2ts_int);
compare(lme_FULL_n6_minus_n2ts_int,lme_FULL_n6)
BIC_for_variable_Array(54) = lme_FULL_n6_minus_n2ts_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%TS: n -2 worse BIC

%upstate n-2 ME
model_spec_FULL_n6_minus_n2state_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All +  n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +  LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2state_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2state_ME);
compare(lme_FULL_n6_minus_n2state_ME,lme_FULL_n6)
BIC_for_variable_Array(29) = lme_FULL_n6_minus_n2state_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove upstate n-2 ME

%upstate:n2 int
model_spec_FULL_n6_minus_n2state_int= 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All +  HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +  LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n2state_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n2state_int);
compare(lme_FULL_n6_minus_n2state_int,lme_FULL_n6)
BIC_for_variable_Array(66) = lme_FULL_n6_minus_n2state_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%rempve i[state n -2:int

%now n-3 variables
%only   ipi2 ME and ipi2 int are sig
%we will also keep n - 2 ipi ME as we have the interaction
%therefore, we will test  ipi3 ME and int, and also check for HEn-3 just in
%case 

%n3 he int
model_spec_FULL_n6_minus_n3he_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +     ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n3he_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n3he_int);
compare(lme_FULL_n6_minus_n3he_int,lme_FULL_n6)
BIC_for_variable_Array(49) = lme_FULL_n6_minus_n3he_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove  n3 he:int 

%n-3 he me
model_spec_FULL_n6_minus_n3he_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All +  ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n3he_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n3he_ME);
compare(lme_FULL_n6_minus_n3he_ME,lme_FULL_n6)
BIC_for_variable_Array(17) = lme_FULL_n6_minus_n3he_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove n - 3 he ME

%ipi3 ME 
model_spec_FULL_n6_minus_n3ipi_ME = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All + ipi3:n_minus_three_Durations_All +  n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All  + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n3ipi_ME = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n3ipi_ME);
compare(lme_FULL_n6_minus_n3ipi_ME,lme_FULL_n6)
BIC_for_variable_Array(24) = lme_FULL_n6_minus_n3ipi_ME.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove n3 ipi ME

%ipi3:n3 int 
model_spec_FULL_n6_minus_n3ipi_int = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +   n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + ipi3 + HE_n_3_Indicator_All  + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
lme_FULL_n6_minus_n3ipi_int = fitlme(T10_Logical_and_Continuous,model_spec_FULL_n6_minus_n3ipi_int);
compare(lme_FULL_n6_minus_n3ipi_int,lme_FULL_n6)
BIC_for_variable_Array(61) = lme_FULL_n6_minus_n3ipi_int.ModelCriterion.BIC - lme_FULL_n6.ModelCriterion.BIC;
%remove ipi3:n3 int

%thus, after n -2 we will remove ALL terms as either main effects or
%interactions, aside from the durations themselves.
model_spec_FULL_n6 = 'LP_Durations_All ~ moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All + moving_average_lp_length_n7andback_All:up_state_idx_n1_All  + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All + n_minus_one_Durations_All:up_state_idx_n1_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All + up_state_idx_n1_All + n_minus_two_Durations_All:LP_Timestamps_All + n_minus_two_Durations_All:criteria_percent_indicator +   n_minus_two_Durations_All:HE_n_2_Indicator_All +  ipi2:n_minus_two_Durations_All + n_minus_two_Durations_All:n_minus_two_All + n_minus_two_Durations_All:up_state_idx_n2_All + HE_n_2_Indicator_All + ipi2 + n_minus_two_All + up_state_idx_n2_All + n_minus_three_Durations_All:LP_Timestamps_All + n_minus_three_Durations_All:criteria_percent_indicator +   n_minus_three_Durations_All:HE_n_3_Indicator_All +  ipi3:n_minus_three_Durations_All + n_minus_three_Durations_All:n_minus_three_All + n_minus_three_Durations_All:up_state_idx_n3_All + HE_n_3_Indicator_All + ipi3 + n_minus_three_All + up_state_idx_n3_All + n_minus_four_Durations_All:LP_Timestamps_All + n_minus_four_Durations_All:criteria_percent_indicator +   n_minus_four_Durations_All:HE_n_4_Indicator_All +  ipi4:n_minus_four_Durations_All + n_minus_four_Durations_All:n_minus_four_All + n_minus_four_Durations_All:up_state_idx_n4_All  + HE_n_4_Indicator_All + ipi4 + n_minus_four_All + up_state_idx_n4_All +n_minus_five_Durations_All:LP_Timestamps_All + n_minus_five_Durations_All:criteria_percent_indicator +   n_minus_five_Durations_All:HE_n_5_Indicator_All +  ipi5:n_minus_five_Durations_All + n_minus_five_Durations_All:n_minus_five_All + n_minus_five_Durations_All:up_state_idx_n5_All  +HE_n_5_Indicator_All + ipi5 + n_minus_five_All + up_state_idx_n5_All +n_minus_six_Durations_All:LP_Timestamps_All + n_minus_six_Durations_All:criteria_percent_indicator +   n_minus_six_Durations_All:HE_n_6_Indicator_All +  ipi6:n_minus_six_Durations_All + n_minus_six_Durations_All:n_minus_six_All + n_minus_six_Durations_All:up_state_idx_n6_All + HE_n_6_Indicator_All + ipi6 + n_minus_six_All + up_state_idx_n6_All + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';

%% Reduced model 
model_spec_n6_reduced = 'LP_Durations_All ~  moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +  ipi2:n_minus_two_Durations_All +   ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced= fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced)
compare(LME_n6_reduced,lme_FULL_n6)
lme_FULL_n6.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC

% get coef of partial determination from this reduced model...
% also do BIC-based selection on this smaller model...
LME_n6_reduced_names = LME_n6_reduced.CoefficientNames';
LME_n6_reduced_coef = LME_n6_reduced.Coefficients.Estimate;
LME_n6_reduced_se = LME_n6_reduced.Coefficients.SE;
LME_n6_reduced_pval = LME_n6_reduced.Coefficients.pValue;
LME_n6_reduced_ftest = anova(LME_n6_reduced);
LME_n6_reduced_ftest_pval = LME_n6_reduced_ftest.pValue;
LME_n6_reduced_ftest_fstat = LME_n6_reduced_ftest.FStat	;

Reduced_BIC_for_variable_Array = nan(length(LME_n6_reduced_names),1);
%lets do BIC for those different variables

%ipi2
%ipi2 n2 me
model_spec_n6_reduced_minus_ipi2me = 'LP_Durations_All ~  moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +     moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_ipi2me  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_ipi2me);
compare(LME_n6_reduced_minus_ipi2me,LME_n6_reduced)
Reduced_BIC_for_variable_Array(13) = LME_n6_reduced_minus_ipi2me.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
%ipi2 me no improvement in bic

%ipi2:n2 dur
model_spec_n6_reduced_minus_ipi2int = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +       ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_ipi2int  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_ipi2int);
compare(LME_n6_reduced_minus_ipi2int,LME_n6_reduced)
Reduced_BIC_for_variable_Array(20) = LME_n6_reduced_minus_ipi2int.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
%keep ipi2:n2, thus also keep the ipi2 n2 ME

%n1 dur
model_spec_n6_reduced_minus_n1 = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All +  n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_n1  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_n1);
compare(LME_n6_reduced_minus_n1,LME_n6_reduced)
Reduced_BIC_for_variable_Array(3) = LME_n6_reduced_minus_n1.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(3) = (LME_n6_reduced_minus_n1.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_n1.SSE;
%n1 ME is neg by BIC, but due to interactions. Keep

%n2dur
model_spec_n6_reduced_minus_n2 = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All +  n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_n2  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_n2);
compare(LME_n6_reduced_minus_n2,LME_n6_reduced)
Reduced_BIC_for_variable_Array(4) = LME_n6_reduced_minus_n2.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(4) = (LME_n6_reduced_minus_n2.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_n2.SSE;

%n3dur
model_spec_n6_reduced_minus_n3 = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All +  n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_n3  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_n3);
compare(LME_n6_reduced_minus_n3,LME_n6_reduced)
Reduced_BIC_for_variable_Array(5) = LME_n6_reduced_minus_n3.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(5) = (LME_n6_reduced_minus_n3.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_n3.SSE;
%n4dur
model_spec_n6_reduced_minus_n4 = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All +  n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_n4  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_n4);
compare(LME_n6_reduced_minus_n4,LME_n6_reduced)
Reduced_BIC_for_variable_Array(6) = LME_n6_reduced_minus_n4.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(6) = (LME_n6_reduced_minus_n4.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_n4.SSE;
%n5dur
model_spec_n6_reduced_minus_n5 = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All +  n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_n5  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_n5);
compare(LME_n6_reduced_minus_n5,LME_n6_reduced)
Reduced_BIC_for_variable_Array(7) = LME_n6_reduced_minus_n5.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(7) = (LME_n6_reduced_minus_n5.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_n5.SSE;
%n6dur
model_spec_n6_reduced_minus_n6 = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All +    LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_n6  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_n6);
compare(LME_n6_reduced_minus_n6,LME_n6_reduced)
Reduced_BIC_for_variable_Array(8) = LME_n6_reduced_minus_n6.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(8) = (LME_n6_reduced_minus_n6.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_n6.SSE;
%mov avg ME
model_spec_n6_reduced_minus_MA = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  +  n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_MA  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_MA);
compare(LME_n6_reduced_minus_MA,LME_n6_reduced)
Reduced_BIC_for_variable_Array(14) = LME_n6_reduced_minus_MA.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(14) = (LME_n6_reduced_minus_MA.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_MA.SSE;

%h1 n1 me
model_spec_n6_reduced_minus_he_me = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +   ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_he_me  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_he_me);
compare(LME_n6_reduced_minus_he_me,LME_n6_reduced)
Reduced_BIC_for_variable_Array(10) = LME_n6_reduced_minus_he_me.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(10) = (LME_n6_reduced_minus_he_me.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_he_me.SSE;

%he:n1 dur int
model_spec_n6_reduced_minus_he_n1int = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +      ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_he_n1int  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_he_n1int);
compare(LME_n6_reduced_minus_he_n1int,LME_n6_reduced)
Reduced_BIC_for_variable_Array(17) = LME_n6_reduced_minus_he_n1int.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(17) = (LME_n6_reduced_minus_he_n1int.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_he_n1int.SSE;

%he:MA dur int
model_spec_n6_reduced_minus_he_MAint = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +     ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_he_MAint  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_he_MAint);
compare(LME_n6_reduced_minus_he_MAint,LME_n6_reduced)
Reduced_BIC_for_variable_Array(23) = LME_n6_reduced_minus_he_MAint.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(23) = (LME_n6_reduced_minus_he_MAint.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_he_MAint.SSE;

%ipi1 me
model_spec_n6_reduced_minus_ipi1_me = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_ipi1_me  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_ipi1_me);
compare(LME_n6_reduced_minus_ipi1_me,LME_n6_reduced)
Reduced_BIC_for_variable_Array(12) = LME_n6_reduced_minus_ipi1_me.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(12) = (LME_n6_reduced_minus_ipi1_me.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_ipi1_me.SSE;

%ipi1 : n1 dur int
model_spec_n6_reduced_minus_ipi1_n1int = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_ipi1_n1int  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_ipi1_n1int);
compare(LME_n6_reduced_minus_ipi1_n1int,LME_n6_reduced)
Reduced_BIC_for_variable_Array(19) = LME_n6_reduced_minus_ipi1_n1int.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(19) = (LME_n6_reduced_minus_ipi1_n1int.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_ipi1_n1int.SSE;

%ipi1 : MA dur int
model_spec_n6_reduced_minus_ipi1_MAint = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_ipi1_MAint  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_ipi1_MAint);
compare(LME_n6_reduced_minus_ipi1_MAint,LME_n6_reduced)
Reduced_BIC_for_variable_Array(25) = LME_n6_reduced_minus_ipi1_MAint.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(25) = (LME_n6_reduced_minus_ipi1_MAint.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_ipi1_MAint.SSE;

%Rewn1 ME
model_spec_n6_reduced_minus_rew_me = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 +     ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_rew_me  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_rew_me);
compare(LME_n6_reduced_minus_rew_me,LME_n6_reduced)
Reduced_BIC_for_variable_Array(2) = LME_n6_reduced_minus_rew_me.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(2) = (LME_n6_reduced_minus_rew_me.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_rew_me.SSE;

%Rewn1 : n1 dur int
model_spec_n6_reduced_minus_rew_n1int = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All +   HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_rew_n1int  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_rew_n1int);
compare(LME_n6_reduced_minus_rew_n1int,LME_n6_reduced)
Reduced_BIC_for_variable_Array(15) = LME_n6_reduced_minus_rew_n1int.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(15) = (LME_n6_reduced_minus_rew_n1int.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_rew_n1int.SSE;

%Rewn1 : MA dur int
model_spec_n6_reduced_minus_rew_MAint = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_rew_MAint  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_rew_MAint);
compare(LME_n6_reduced_minus_rew_MAint,LME_n6_reduced)
Reduced_BIC_for_variable_Array(21) = LME_n6_reduced_minus_rew_MAint.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(21) = (LME_n6_reduced_minus_rew_MAint.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_rew_MAint.SSE;

%ts ME
model_spec_n6_reduced_minus_ts_me = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +    criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_ts_me  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_ts_me);
compare(LME_n6_reduced_minus_ts_me,LME_n6_reduced)
Reduced_BIC_for_variable_Array(11) = LME_n6_reduced_minus_ts_me.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(11) = (LME_n6_reduced_minus_ts_me.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_ts_me.SSE;

%ts n1 dur int
model_spec_n6_reduced_minus_ts_n1int = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   +  n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_ts_n1int  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_ts_n1int);
compare(LME_n6_reduced_minus_ts_n1int,LME_n6_reduced)
Reduced_BIC_for_variable_Array(18) = LME_n6_reduced_minus_ts_n1int.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(18) = (LME_n6_reduced_minus_ts_n1int.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_ts_n1int.SSE;

%ts MA int
model_spec_n6_reduced_minus_ts_MAint = 'LP_Durations_All ~    moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_ts_MAint  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_ts_MAint);
compare(LME_n6_reduced_minus_ts_MAint,LME_n6_reduced)
Reduced_BIC_for_variable_Array(24) = LME_n6_reduced_minus_ts_MAint.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(24) = (LME_n6_reduced_minus_ts_MAint.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_ts_MAint.SSE;

%crit ME
model_spec_n6_reduced_minus_crit_me = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All +  (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_crit_me  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_crit_me);
compare(LME_n6_reduced_minus_crit_me,LME_n6_reduced)
Reduced_BIC_for_variable_Array(9) = LME_n6_reduced_minus_crit_me.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(9) = (LME_n6_reduced_minus_crit_me.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_crit_me.SSE;

%crit n1 dur int
model_spec_n6_reduced_minus_crit_n1int = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All + moving_average_lp_length_n7andback_All:criteria_percent_indicator +   moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_crit_n1int  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_crit_n1int);
compare(LME_n6_reduced_minus_crit_n1int,LME_n6_reduced)
Reduced_BIC_for_variable_Array(16) = LME_n6_reduced_minus_crit_n1int.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(16) = (LME_n6_reduced_minus_crit_n1int.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_crit_n1int.SSE;

%crit MA int
model_spec_n6_reduced_minus_crit_MAint = 'LP_Durations_All ~   moving_average_lp_length_n7andback_All:LP_Timestamps_All +    moving_average_lp_length_n7andback_All:HE_n_1_Indicator_All +  ipi1:moving_average_lp_length_n7andback_All + moving_average_lp_length_n7andback_All:n_minus_one_All   + n_minus_one_Durations_All:LP_Timestamps_All + n_minus_one_Durations_All:criteria_percent_indicator +    n_minus_one_Durations_All:HE_n_1_Indicator_All +  ipi1:n_minus_one_Durations_All + n_minus_one_Durations_All:n_minus_one_All  +  HE_n_1_Indicator_All + ipi1 + n_minus_one_All  +    ipi2:n_minus_two_Durations_All +    ipi2  + moving_average_lp_length_n7andback_All + n_minus_one_Durations_All + n_minus_two_Durations_All + n_minus_three_Durations_All + n_minus_four_Durations_All + n_minus_five_Durations_All + n_minus_six_Durations_All +   LP_Timestamps_All + criteria_percent_indicator + (1|mouse_indicator)+(1|day_indicator)';
LME_n6_reduced_minus_crit_MAint  = fitlme(T10_Logical_and_Continuous,model_spec_n6_reduced_minus_crit_MAint);
compare(LME_n6_reduced_minus_crit_MAint,LME_n6_reduced)
Reduced_BIC_for_variable_Array(22) = LME_n6_reduced_minus_crit_MAint.ModelCriterion.BIC - LME_n6_reduced.ModelCriterion.BIC;
CPD_for_variable_Array(22) = (LME_n6_reduced_minus_crit_MAint.SSE  - LME_n6_reduced.SSE)/LME_n6_reduced_minus_crit_MAint.SSE;

